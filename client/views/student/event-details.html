<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Event Details</title>
  <link rel="stylesheet" href="../../public/css/dashboard.css" />
</head>
<body>

  <div class="dashboard-container">

    <!-- Header -->
    <header class="dashboard-header">
      <h2>Event Details</h2>
      <div class="dashboard-header-buttons">
        <button onclick="goBack()" class="dashboard-btn">Back to Dashboard</button>
        <button id="logoutBtn" class="dashboard-btn logout-btn">Logout</button>
      </div>
    </header>

    <!-- Event Details Section -->
    <section class="dashboard-card" style="margin-top:20px;">

      <h3 id="eventTitle">Event Title</h3>

      <p><strong>Description:</strong> 
        <span id="eventDescription"></span>
      </p>

      <p><strong>Date & Time:</strong> 
        <span id="eventDate"></span>
      </p>

      <p><strong>Venue:</strong> 
        <span id="eventVenue"></span>
      </p>

      <p><strong>Fee:</strong> 
        <span id="eventFee"></span>
      </p>

      <br />
      <button id="registerBtn" class="dashboard-btn">Register</button>
      <p id="registrationMessage" style="margin-top:10px; font-weight:bold;"></p>


    </section>

  </div>

  <script>
  // Protect Page
  if (!localStorage.getItem("isLoggedIn")) {
    window.location.href = "../auth/login.html";
  }

  const selectedEventId = parseInt(localStorage.getItem("selectedEventId"));

  if (!selectedEventId) {
    alert("No event selected.");
    window.location.href = "dashboard.html";
  }

  // Events Data (Must match dashboard IDs)
  const events = [
    {
      id: 1,
      title: "Hackathon 2026",
      description: "24-hour coding competition for students.",
      date: "20 March 2026, 10:00 AM",
      venue: "Main Auditorium",
      fee: "₹200"
    },
    {
      id: 2,
      title: "Web Dev Workshop",
      description: "Hands-on workshop on modern web development.",
      date: "15 March 2026, 9:00 AM",
      venue: "Lab 2",
      fee: "Free"
    },
    {
      id: 3,
      title: "AI Seminar",
      description: "Seminar on Artificial Intelligence trends.",
      date: "10 March 2026, 11:00 AM",
      venue: "Seminar Hall",
      fee: "₹100"
    }
  ];

  const event = events.find(e => e.id === selectedEventId);

  if (!event) {
    alert("Event not found.");
    window.location.href = "dashboard.html";
  }

  // Display Event Details
  document.getElementById("eventTitle").innerText = event.title;
  document.getElementById("eventDescription").innerText = event.description;
  document.getElementById("eventDate").innerText = event.date;
  document.getElementById("eventVenue").innerText = event.venue;
  document.getElementById("eventFee").innerText = event.fee;

  // Register


  const registerBtn = document.getElementById("registerBtn");
  const message = document.getElementById("registrationMessage");

  let registeredEvents = JSON.parse(localStorage.getItem("registeredEvents")) || [];

  // If already registered when page loads
  if (registeredEvents.includes(event.id)) {
    registerBtn.innerText = "Registered";
    registerBtn.disabled = true;
    registerBtn.style.backgroundColor = "gray";
    message.innerHTML = "<span style='color:red;'>You have already registered for this event.</span>";
  }

  registerBtn.addEventListener("click", function () {

    if (registeredEvents.includes(event.id)) {
      message.innerHTML = "<span style='color:red;'>You have already registered for this event.</span>";
      return;
    }

    registeredEvents.push(event.id);
    localStorage.setItem("registeredEvents", JSON.stringify(registeredEvents));

    registerBtn.innerText = "Registered";
    registerBtn.disabled = true;
    registerBtn.style.backgroundColor = "gray";
    

    message.innerHTML = "<span style='color:green;'>Successfully registered for this event.</span>";
  });





  // Back
  function goBack() {
    window.location.href = "dashboard.html";
  }

  // Logout
  document.getElementById("logoutBtn").addEventListener("click", function () {
    localStorage.removeItem("isLoggedIn");
    localStorage.removeItem("selectedEventId");
    alert("Logged out successfully!");
    window.location.href = "../auth/login.html";
  });
</script>


</body>
</html>
