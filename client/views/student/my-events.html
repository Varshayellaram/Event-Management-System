<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>My Registered Events</title>
  <link rel="stylesheet" href="../../public/css/dashboard.css" />
</head>
<body>

  <div class="dashboard-container">

    <!-- Header -->
    <header class="dashboard-header">
      <h2>My Registered Events</h2>
      <div class="dashboard-header-buttons">
        <button onclick="goToDashboard()" class="dashboard-btn">
          Back to Dashboard
        </button>
        <button id="logoutBtn" class="dashboard-btn logout-btn">
          Logout
        </button>
      </div>
    </header>

    <!-- Events Section -->
    <section class="dashboard-events">
      <div id="myEventsContainer" class="event-list">
        <p>Loading registered events...</p>
      </div>
    </section>

  </div>

  <script>
    // üîê Protect Page
    if (!localStorage.getItem("isLoggedIn")) {
      window.location.href = "../auth/login.html";
    }

    // Same Events Data (must match other pages)
    const events = [
      {
        id: 1,
        title: "Hackathon 2026",
        date: "20 March 2026",
        venue: "Main Auditorium",
        status: "upcoming"
      },
      {
        id: 2,
        title: "Web Dev Workshop",
        date: "15 March 2026",
        venue: "Lab 2",
        status: "ongoing"
      },
      {
        id: 3,
        title: "AI Seminar",
        date: "10 March 2026",
        venue: "Seminar Hall",
        status: "completed"
      }
    ];

    function loadRegisteredEvents() {
      const container = document.getElementById("myEventsContainer");
      container.innerHTML = "";

      const registeredEvents = JSON.parse(localStorage.getItem("registeredEvents")) || [];

      if (registeredEvents.length === 0) {
        container.innerHTML = "<p>You have not registered for any events yet.</p>";
        return;
      }

      const myEvents = events.filter(event => registeredEvents.includes(event.id));

      myEvents.forEach(event => {
        const div = document.createElement("div");
        div.className = "event-card";
        div.innerHTML = `
          <h4>${event.title}</h4>
          <p><strong>Date:</strong> ${event.date}</p>
          <p><strong>Venue:</strong> ${event.venue}</p>
          <p><strong>Status:</strong> ${event.status}</p>
          <button onclick="openEventDetails(${event.id})">
            View Details
          </button>
        `;
        container.appendChild(div);
      });
    }

    function openEventDetails(id) {
      localStorage.setItem("selectedEventId", id);
      window.location.href = "event-details.html";
    }

    function goToDashboard() {
      window.location.href = "dashboard.html";
    }

    // Logout
    document.getElementById("logoutBtn").addEventListener("click", function () {
      localStorage.removeItem("isLoggedIn");
      alert("Logged out successfully!");
      window.location.href = "../auth/login.html";
    });

    loadRegisteredEvents();
  </script>

</body>
</html>
